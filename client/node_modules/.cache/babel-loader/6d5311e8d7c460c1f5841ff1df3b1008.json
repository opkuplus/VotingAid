{"ast":null,"code":"import _objectSpread from\"C:/Git/VotingAid-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Git/VotingAid-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Git/VotingAid-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Git/VotingAid-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Git/VotingAid-1/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import jwt from\"jwt-decode\";import React,{createContext,Component}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext();var UserContextProvider=/*#__PURE__*/function(_Component){_inherits(UserContextProvider,_Component);var _super=_createSuper(UserContextProvider);function UserContextProvider(props){var _this;_classCallCheck(this,UserContextProvider);_this=_super.call(this,props);_this.changeLanguage=function(e){_this.setState({language:e});sessionStorage.setItem('language',e);};_this.changeUser=function(user,email,school,loggedIn,token){_this.setState({user:user,email:email,school:school,loggedIn:loggedIn,token:token});};_this.logOut=function(){_this.changeUser('Quest','','',false,'');/*sessionStorage.removeItem('email');\r\n    sessionStorage.removeItem('status');*/sessionStorage.removeItem('token');};_this.checkExistingLogin=function(){/*let email = sessionStorage.getItem('email');\r\n    let status = sessionStorage.getItem('status');*/var storedToken=sessionStorage.getItem('token');if(storedToken){var decodedToken=jwt(storedToken);_this.changeUser(decodedToken.status,decodedToken.email,decodedToken.school,true,storedToken);}};_this.state=_this.existingLogin()||{user:'Quest',email:'',school:'',loggedIn:false,language:'fin',token:''};return _this;}_createClass(UserContextProvider,[{key:\"componentDidMount\",value:function componentDidMount(){if(sessionStorage.getItem('language')){this.setState({language:sessionStorage.getItem('language')});}}},{key:\"existingLogin\",value:function existingLogin(){var storedToken=sessionStorage.getItem('token');if(storedToken){var decodedToken=jwt(storedToken);return{user:decodedToken.status,email:decodedToken.email,school:decodedToken.school,loggedIn:true,token:storedToken};}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(UserContext.Provider,{value:_objectSpread(_objectSpread({},this.state),{},{changeUser:this.changeUser,checkExistingLogin:this.checkExistingLogin,logOut:this.logOut,changeLanguage:this.changeLanguage}),children:this.props.children});}}]);return UserContextProvider;}(Component);export default UserContextProvider;","map":{"version":3,"sources":["C:/Git/VotingAid-1/client/src/context/userContext.js"],"names":["jwt","React","createContext","Component","UserContext","UserContextProvider","props","changeLanguage","e","setState","language","sessionStorage","setItem","changeUser","user","email","school","loggedIn","token","logOut","removeItem","checkExistingLogin","storedToken","getItem","decodedToken","status","state","existingLogin","children"],"mappings":"+rBAAA,MAAOA,CAAAA,GAAP,KAAgB,YAAhB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,aAAhB,CAA+BC,SAA/B,KAAgD,OAAhD,C,2CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGF,aAAa,EAAjC,C,GACDG,CAAAA,mB,0HACJ,6BAAYC,KAAZ,CAAmB,qDACjB,uBAAMA,KAAN,EADiB,MAkBnBC,cAlBmB,CAkBF,SAACC,CAAD,CAAO,CACtB,MAAKC,QAAL,CAAc,CAAEC,QAAQ,CAAEF,CAAZ,CAAd,EACAG,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAmCJ,CAAnC,EACD,CArBkB,OAuBnBK,UAvBmB,CAuBN,SAACC,IAAD,CAAOC,KAAP,CAAcC,MAAd,CAAsBC,QAAtB,CAAgCC,KAAhC,CAA0C,CACrD,MAAKT,QAAL,CAAc,CACZK,IAAI,CAAEA,IADM,CAEZC,KAAK,CAAEA,KAFK,CAGZC,MAAM,CAAEA,MAHI,CAIZC,QAAQ,CAAEA,QAJE,CAKZC,KAAK,CAAEA,KALK,CAAd,EAOD,CA/BkB,OAiCnBC,MAjCmB,CAiCV,UAAM,CACb,MAAKN,UAAL,CAAgB,OAAhB,CAAyB,EAAzB,CAA6B,EAA7B,CAAiC,KAAjC,CAAwC,EAAxC,EACA;AACJ,0CACIF,cAAc,CAACS,UAAf,CAA0B,OAA1B,EACD,CAtCkB,OAwCnBC,kBAxCmB,CAwCE,UAAM,CACzB;AACJ,oDACI,GAAIC,CAAAA,WAAW,CAAGX,cAAc,CAACY,OAAf,CAAuB,OAAvB,CAAlB,CACA,GAAID,WAAJ,CAAiB,CACf,GAAIE,CAAAA,YAAY,CAAGxB,GAAG,CAACsB,WAAD,CAAtB,CACA,MAAKT,UAAL,CAAgBW,YAAY,CAACC,MAA7B,CAAqCD,YAAY,CAACT,KAAlD,CAAyDS,YAAY,CAACR,MAAtE,CAA8E,IAA9E,CAAoFM,WAApF,EACD,CACF,CAhDkB,CAEjB,MAAKI,KAAL,CAAa,MAAKC,aAAL,IAAwB,CACnCb,IAAI,CAAE,OAD6B,CAEnCC,KAAK,CAAE,EAF4B,CAGnCC,MAAM,CAAE,EAH2B,CAInCC,QAAQ,CAAE,KAJyB,CAKnCP,QAAQ,CAAE,KALyB,CAMnCQ,KAAK,CAAE,EAN4B,CAArC,CAFiB,aAUlB,C,iEAED,4BAAoB,CAClB,GAAIP,cAAc,CAACY,OAAf,CAAuB,UAAvB,CAAJ,CAAwC,CACtC,KAAKd,QAAL,CAAc,CAAEC,QAAQ,CAAEC,cAAc,CAACY,OAAf,CAAuB,UAAvB,CAAZ,CAAd,EACD,CACF,C,6BAkCD,wBAAgB,CACd,GAAID,CAAAA,WAAW,CAAGX,cAAc,CAACY,OAAf,CAAuB,OAAvB,CAAlB,CACA,GAAID,WAAJ,CAAiB,CACf,GAAIE,CAAAA,YAAY,CAAGxB,GAAG,CAACsB,WAAD,CAAtB,CACA,MAAO,CACLR,IAAI,CAAEU,YAAY,CAACC,MADd,CAELV,KAAK,CAAES,YAAY,CAACT,KAFf,CAGLC,MAAM,CAAEQ,YAAY,CAACR,MAHhB,CAILC,QAAQ,CAAE,IAJL,CAKLC,KAAK,CAAEI,WALF,CAAP,CAOD,CACF,C,sBAED,iBAAS,CACP,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,gCACtB,KAAKI,KADiB,MAEzBb,UAAU,CAAE,KAAKA,UAFQ,CAGzBQ,kBAAkB,CAAE,KAAKA,kBAHA,CAIzBF,MAAM,CAAE,KAAKA,MAJY,CAKzBZ,cAAc,CAAE,KAAKA,cALI,EAA3B,UAOG,KAAKD,KAAL,CAAWsB,QAPd,EADF,CAWD,C,iCA7E+BzB,S,EAgFlC,cAAeE,CAAAA,mBAAf","sourcesContent":["import jwt from \"jwt-decode\";\r\nimport React, { createContext, Component } from 'react';\r\n\r\nexport const UserContext = createContext();\r\nclass UserContextProvider extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = this.existingLogin() || {\r\n      user: 'Quest',\r\n      email: '',\r\n      school: '',\r\n      loggedIn: false,\r\n      language: 'fin',\r\n      token: '',\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (sessionStorage.getItem('language')) {\r\n      this.setState({ language: sessionStorage.getItem('language') })\r\n    }\r\n  }\r\n\r\n  changeLanguage = (e) => {\r\n    this.setState({ language: e });\r\n    sessionStorage.setItem('language', e);\r\n  }\r\n\r\n  changeUser = (user, email, school, loggedIn, token) => {\r\n    this.setState({\r\n      user: user,\r\n      email: email,\r\n      school: school,\r\n      loggedIn: loggedIn,\r\n      token: token,\r\n    });\r\n  }\r\n\r\n  logOut = () => {\r\n    this.changeUser('Quest', '', '', false, '');\r\n    /*sessionStorage.removeItem('email');\r\n    sessionStorage.removeItem('status');*/\r\n    sessionStorage.removeItem('token');\r\n  }\r\n\r\n  checkExistingLogin = () => {\r\n    /*let email = sessionStorage.getItem('email');\r\n    let status = sessionStorage.getItem('status');*/\r\n    let storedToken = sessionStorage.getItem('token');\r\n    if (storedToken) {\r\n      let decodedToken = jwt(storedToken)\r\n      this.changeUser(decodedToken.status, decodedToken.email, decodedToken.school, true, storedToken);\r\n    }\r\n  }\r\n\r\n  existingLogin() {\r\n    let storedToken = sessionStorage.getItem('token')\r\n    if (storedToken) {\r\n      let decodedToken = jwt(storedToken)\r\n      return {\r\n        user: decodedToken.status,\r\n        email: decodedToken.email,\r\n        school: decodedToken.school,\r\n        loggedIn: true,\r\n        token: storedToken,\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <UserContext.Provider value={{\r\n        ...this.state,\r\n        changeUser: this.changeUser,\r\n        checkExistingLogin: this.checkExistingLogin,\r\n        logOut: this.logOut,\r\n        changeLanguage: this.changeLanguage,\r\n      }}>\r\n        {this.props.children}\r\n      </UserContext.Provider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UserContextProvider;"]},"metadata":{},"sourceType":"module"}